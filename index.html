<!DOCTYPE html>
<html>
  <head>
    <title>Geelong dashboard 2.0 (Auto-refresh each 5 minutes)</title>
    <link rel="icon" type="image/x-icon" href="./Geelong2.png" />
    <style>
      body, html {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        overflow: hidden;
      }
      iframe {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        border: none;
      }
    </style>
  </head>
  <body>
    <iframe
      id="powerbi-frame"
      src="https://app.powerbi.com/view?r=eyJrIjoiYjMzMDFiNGQtZTZlYy00MTMyLTgyMWEtZWQ1NzBlMzk5ZTVlIiwidCI6IjY5YWNkMjU2LTA5NTQtNDg1Yy1iYmMyLThkMzI4ZmQ3ZjFlOCJ9"
      allowfullscreen="true"
    ></iframe>
    <script>
      // Function to save the filter state to local storage
      function saveFilterState() {
        var iframe = document.querySelector("iframe");
        var currentSrc = iframe.src;
        localStorage.setItem("powerbi-filter", currentSrc);
      }

      // Function to restore the filter state from local storage
      function restoreFilterState() {
        var iframe = document.querySelector("iframe");
        var savedSrc = localStorage.getItem("powerbi-filter");
        if (savedSrc) {
          iframe.src = savedSrc;
        }
      }

      // Set the interval for refreshing the iframe
      setInterval(function () {
        saveFilterState();
        restoreFilterState();
      }, 300000); // Refresh every 300,000 milliseconds (5 minutes)

      // Restore the filter state when the page loads
      window.onload = function () {
        restoreFilterState();
      };
    </script>
  </body>
</html>
